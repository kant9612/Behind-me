<div class="container">
  <div class="row">
  	<div class="col-md-3">
      <h2>User info</h2>
      <%= render 'users/info', user: @list.user %>
	  </div>
		<div class="col-md-8 offset-md-1">
		  <h2>List detail</h2>
		    <table class="table">
				  <tr id="list_<%= @list.id %>">
				    <td><%= attachment_image_tag @list.user, :profile_image, :fill, 100, 100, format:'jpeg', fallback: "no_image.jpg" %><br>
				    <%= link_to @list.user.name, user_path(@list.user.id) %></td>
				    <td><%= link_to @list.list_title, list_path(@list.id) %></td>
				    <td>
				    <% @list.categories.each do |category| %>
						  <%= category.name %>
						<% end %>
						</td>
				    <td><%= @list.description %></td>
				    <td class="comments-count">コメント数: <%= @list.list_comments.count %></td>
				    <td class="like-btn_<%= @list.id %>"><%= render partial: "likes/like-btn", locals: { list: @list} %></td>
				    <% if @list.user_id == current_user.id %>
              <td><%= link_to "Edit", edit_list_path(@list.id), class: "btn-sm btn-success edit_list_#{@list.id}" %></td>
              <td><%= link_to "Destroy", list_path(@list.id), method: :delete, "data-confirm" => "削除しますか？", class: "btn-sm btn-danger destroy_list_#{@list.id}" %></td>
            <% end %>
				  </tr>
		    </table>
		    <table>
    		  <% @list.movies.each do |movie| %>
    		    <% movie_user = movie.user %>
    		    <tr>
    		    	<td><%= movie.title %></td>
    		    </tr>
    		  <% end %>
    		</table>
    		<table class="reviews">
    			<h5>評価一覧</h5>
    			<%= render "lists/review", { list: @list, review: @review} %>
    		</table>
    		<!--ここに評価機能を実装-->
    		<%= form_with model: @review, url: list_reviews_path(@list.id), local: true do |f| %>
    			<!--評価するリストのid-->
    			<%= f.hidden_field :list_id, { value: @list.id} %>
    			<!--評価の星-->
    			<div class="form-group row" id="star">
  				  <%= f.label :rate,'評価 ', class:'col-md-3 col-form-label' %>
  				  <%= f.hidden_field :rate, id: :review_star %>
  				  <%= f.text_area :comment %>
  				</div>
  				<!--評価javascript-->
  				<script>
  				$('#star').raty({
  				  size     : 36,
  				  starOff:  '<%= asset_path('star-off.png') %>',
  				  starOn : '<%= asset_path('star-on.png') %>',
  				  starHalf: '<%= asset_path('star-half.png') %>',
  				  scoreName: 'review[rate]', // Listモデルのrateカラムに値を保存する
  				  half: true, // ★半分ok
  				});
  				</script>
  				<%= f.submit '評価する', class:"btn btn-success" %>
    		<% end %>
    		<table class="list_comments">
    			<h5>コメント一覧</h5>
    			<%= render partial: "lists/comment", locals: { list: @list, list_comment: @list_comment} %>
    		</table>
    		<%= form_with model:[@list,@list_comment], remote:true do |f| %>
				  <%= f.text_area :comment, size:"90x5", placeholder: "コメントを書く" %>
				  <%= f.submit '送信'%>
				<% end %>
		</div>
  </div>
</div>